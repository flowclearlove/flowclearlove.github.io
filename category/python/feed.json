{
    "version": "https://jsonfeed.org/version/1",
    "title": "让风听见 • All posts by \"python\" category",
    "description": "人生不可能总是顺心如意的，但是持续朝着阳光走，影子就会躲在后面。刺眼，却表明对的方向。",
    "home_page_url": "http://example.com",
    "items": [
        {
            "id": "http://example.com/2023/05/24/python%E5%A4%84%E7%90%86excel%E6%95%99%E7%A8%8B%E7%B3%BB%E5%88%97/",
            "url": "http://example.com/2023/05/24/python%E5%A4%84%E7%90%86excel%E6%95%99%E7%A8%8B%E7%B3%BB%E5%88%97/",
            "title": "python处理excel教程系列",
            "date_published": "2023-05-24T12:25:36.000Z",
            "content_html": "<h2 id=\"概述\"><a href=\"#概述\" class=\"headerlink\" title=\"概述\"></a>概述</h2><blockquote>\n<p>因为工作中经常会需要用到脚本来批量处理excel数据，所以整理一下相关知识点，进行记录复习。</p>\n<p>目前的学习计划是：<code>openpyxl</code>    <code>pandas</code></p>\n</blockquote>\n<h2 id=\"一、openpyxl学习记录\"><a href=\"#一、openpyxl学习记录\" class=\"headerlink\" title=\"一、openpyxl学习记录\"></a>一、openpyxl学习记录</h2><h3 id=\"1-通用脚本函数\"><a href=\"#1-通用脚本函数\" class=\"headerlink\" title=\"1. 通用脚本函数\"></a>1. 通用脚本函数</h3><blockquote>\n<p>下面的函数可以直接进行调用，很是方便</p>\n</blockquote>\n<p>网上找来的，实现的功能：</p>\n<ol>\n<li>获取表格的总行数和总列数</li>\n<li>获取某个单元格的值</li>\n<li>获取某列的所有值</li>\n<li>获取某行所有值</li>\n<li>设置某个单元格的值</li>\n</ol>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs python\"><span class=\"hljs-keyword\">from</span> openpyxl <span class=\"hljs-keyword\">import</span> *<br><br><br><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">ExcelOp</span>(<span class=\"hljs-title class_ inherited__\">object</span>):<br>    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">self, file</span>):<br>        self.file = file<br>        self.wb = load_workbook(self.file)<br>        sheets = self.wb.get_sheet_names()<br>        self.sheet = sheets[<span class=\"hljs-number\">0</span>]<br>        self.ws = self.wb[self.sheet]<br><br>    <span class=\"hljs-comment\"># 获取表格的总行数和总列数</span><br>    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">get_row_clo_num</span>(<span class=\"hljs-params\">self</span>):<br>        rows = self.ws.max_row<br>        columns = self.ws.max_column<br>        <span class=\"hljs-keyword\">return</span> rows, columns<br><br>    <span class=\"hljs-comment\"># 获取某个单元格的值</span><br>    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">get_cell_value</span>(<span class=\"hljs-params\">self, row, column</span>):<br>        cell_value = self.ws.cell(row=row, column=column).value<br>        <span class=\"hljs-keyword\">return</span> cell_value<br><br>    <span class=\"hljs-comment\"># 获取某列的所有值</span><br>    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">get_col_value</span>(<span class=\"hljs-params\">self, column</span>):<br>        rows = self.ws.max_row<br>        column_data = []<br>        <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-number\">1</span>, rows + <span class=\"hljs-number\">1</span>):<br>            cell_value = self.ws.cell(row=i, column=column).value<br>            column_data.append(cell_value)<br>        <span class=\"hljs-keyword\">return</span> column_data<br><br>    <span class=\"hljs-comment\"># 获取某行所有值</span><br>    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">get_row_value</span>(<span class=\"hljs-params\">self, row</span>):<br>        columns = self.ws.max_column<br>        row_data = []<br>        <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-number\">1</span>, columns + <span class=\"hljs-number\">1</span>):<br>            cell_value = self.ws.cell(row=row, column=i).value<br>            row_data.append(cell_value)<br>        <span class=\"hljs-keyword\">return</span> row_data<br><br>    <span class=\"hljs-comment\"># 设置某个单元格的值</span><br>    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">set_cell_value</span>(<span class=\"hljs-params\">self, row, colunm, cellvalue</span>):<br>        <span class=\"hljs-keyword\">try</span>:<br>            self.ws.cell(row=row, column=colunm).value = cellvalue<br>            self.wb.save(self.file)<br>        <span class=\"hljs-keyword\">except</span>:<br>            self.ws.cell(row=row, column=colunm).value = <span class=\"hljs-string\">&quot;writefail&quot;</span><br>            self.wb.save(self.file)<br><br><span class=\"hljs-keyword\">if</span> __name__ == <span class=\"hljs-string\">&quot;__main__&quot;</span>:<br>    excel_op = ExcelOp(file=<span class=\"hljs-string\">&quot;output/photo_name.xlsx&quot;</span>)<br>    first_row = excel_op.get_row_value(<span class=\"hljs-number\">1</span>)<br>    <span class=\"hljs-built_in\">print</span>(first_row)<br>    second_col = excel_op.get_col_value(<span class=\"hljs-number\">2</span>)<br>    <span class=\"hljs-built_in\">print</span>(second_col)<br></code></pre></td></tr></table></figure>\n\n<h3 id=\"2-安装\"><a href=\"#2-安装\" class=\"headerlink\" title=\"2.安装\"></a>2.安装</h3><figure class=\"highlight cmake\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs cmake\">pip <span class=\"hljs-keyword\">install</span> openpyxl<br></code></pre></td></tr></table></figure>\n\n<h3 id=\"3-创建文件\"><a href=\"#3-创建文件\" class=\"headerlink\" title=\"3.创建文件\"></a>3.创建文件</h3><figure class=\"highlight stylus\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs stylus\">from openpyxl import Workbook<br>import <span class=\"hljs-selector-tag\">time</span><br><br>book = <span class=\"hljs-built_in\">Workbook</span>()<br>sheet = book<span class=\"hljs-selector-class\">.active</span><br>#写入数据<span class=\"hljs-number\">1</span><br>sheet<span class=\"hljs-selector-attr\">[<span class=\"hljs-string\">&#x27;A1&#x27;</span>]</span> = <span class=\"hljs-number\">56</span><br>sheet<span class=\"hljs-selector-attr\">[<span class=\"hljs-string\">&#x27;A2&#x27;</span>]</span> = <span class=\"hljs-number\">43</span><br>##写入数据<span class=\"hljs-number\">2</span>（方式<span class=\"hljs-number\">2</span>）<br>sheet<span class=\"hljs-selector-class\">.cell</span>(row=<span class=\"hljs-number\">2</span>, column=<span class=\"hljs-number\">2</span>)<span class=\"hljs-selector-class\">.value</span> = <span class=\"hljs-number\">2</span><br>#写入日期<br>now = <span class=\"hljs-selector-tag\">time</span><span class=\"hljs-selector-class\">.strftime</span>(<span class=\"hljs-string\">&quot;%x&quot;</span>)<br>sheet<span class=\"hljs-selector-attr\">[<span class=\"hljs-string\">&#x27;A3&#x27;</span>]</span> = now<br>#保存文件<br>book<span class=\"hljs-selector-class\">.save</span>(<span class=\"hljs-string\">&quot;sample.xlsx&quot;</span>)<br></code></pre></td></tr></table></figure>\n\n<p><img src=\"image-20230524210328692.png\" alt=\"image-20230524210328692\"></p>\n<h4 id=\"4-列表插入行\"><a href=\"#4-列表插入行\" class=\"headerlink\" title=\"4.列表插入行\"></a>4.列表插入行</h4><figure class=\"highlight gradle\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs gradle\">#!<span class=\"hljs-regexp\">/usr/</span>bin/env python<br><br><span class=\"hljs-keyword\">from</span> openpyxl <span class=\"hljs-keyword\">import</span> Workbook<br><br>book = Workbook()<br>sheet = book.active<br><br>rows = (<br>    (<span class=\"hljs-number\">88</span>, <span class=\"hljs-number\">46</span>, <span class=\"hljs-number\">57</span>),<br>    (<span class=\"hljs-number\">89</span>, <span class=\"hljs-number\">38</span>, <span class=\"hljs-number\">12</span>),<br>    (<span class=\"hljs-number\">23</span>, <span class=\"hljs-number\">59</span>, <span class=\"hljs-number\">78</span>),<br>    (<span class=\"hljs-number\">56</span>, <span class=\"hljs-number\">21</span>, <span class=\"hljs-number\">98</span>),<br>    (<span class=\"hljs-number\">24</span>, <span class=\"hljs-number\">18</span>, <span class=\"hljs-number\">43</span>),<br>    (<span class=\"hljs-number\">34</span>, <span class=\"hljs-number\">15</span>, <span class=\"hljs-number\">67</span>)<br>)<br><br><span class=\"hljs-keyword\">for</span> row in rows:<br>    sheet.<span class=\"hljs-keyword\">append</span>(row)<br><br>book.save(<span class=\"hljs-string\">&#x27;appending.xlsx&#x27;</span>)<br></code></pre></td></tr></table></figure>\n\n<p><img src=\"image-20230524210619588.png\" alt=\"image-20230524210619588\"></p>\n<h3 id=\"5-读取单元格\"><a href=\"#5-读取单元格\" class=\"headerlink\" title=\"5.读取单元格\"></a>5.读取单元格</h3><figure class=\"highlight stylus\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs stylus\">#!/usr/bin/env python<br><br>import openpyxl<br><br>book = openpyxl<span class=\"hljs-selector-class\">.load_workbook</span>(<span class=\"hljs-string\">&#x27;sample.xlsx&#x27;</span>)<br><br>sheet = book<span class=\"hljs-selector-class\">.active</span><br><br>a1 = sheet<span class=\"hljs-selector-attr\">[<span class=\"hljs-string\">&#x27;A1&#x27;</span>]</span><br>a2 = sheet<span class=\"hljs-selector-attr\">[<span class=\"hljs-string\">&#x27;A2&#x27;</span>]</span><br>a3 = sheet<span class=\"hljs-selector-class\">.cell</span>(row=<span class=\"hljs-number\">3</span>, column=<span class=\"hljs-number\">1</span>)<br><br><span class=\"hljs-function\"><span class=\"hljs-title\">print</span><span class=\"hljs-params\">(a1.value)</span></span><br><span class=\"hljs-function\"><span class=\"hljs-title\">print</span><span class=\"hljs-params\">(a2.value)</span></span><br><span class=\"hljs-function\"><span class=\"hljs-title\">print</span><span class=\"hljs-params\">(a3.value)</span></span><br></code></pre></td></tr></table></figure>\n\n<p><img src=\"image-20230524210744964.png\" alt=\"image-20230524210744964\"></p>\n<h3 id=\"6-读取多个单元格\"><a href=\"#6-读取多个单元格\" class=\"headerlink\" title=\"6.读取多个单元格\"></a>6.读取多个单元格</h3><p>假设数据：</p>\n<p><img src=\"image-20230524210937671.png\" alt=\"image-20230524210937671\"></p>\n<figure class=\"highlight stylus\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs stylus\">#!/usr/bin/env python<br><br>import openpyxl<br><br>book = openpyxl<span class=\"hljs-selector-class\">.load_workbook</span>(<span class=\"hljs-string\">&#x27;items.xlsx&#x27;</span>)<br><br>sheet = book<span class=\"hljs-selector-class\">.active</span><br><br>cells = sheet<span class=\"hljs-selector-attr\">[<span class=\"hljs-string\">&#x27;A1&#x27;</span>: <span class=\"hljs-string\">&#x27;B6&#x27;</span>]</span><br><br><span class=\"hljs-keyword\">for</span> c1, c2 <span class=\"hljs-keyword\">in</span> cells:<br>    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;&#123;0:8&#125; &#123;1:8&#125;&quot;</span><span class=\"hljs-selector-class\">.format</span>(c1<span class=\"hljs-selector-class\">.value</span>, c2.value))<br></code></pre></td></tr></table></figure>\n\n<h3 id=\"7-按行迭代\"><a href=\"#7-按行迭代\" class=\"headerlink\" title=\"7.按行迭代\"></a>7.按行迭代</h3><figure class=\"highlight routeros\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs routeros\"><span class=\"hljs-comment\">#!/usr/bin/env python</span><br><br><span class=\"hljs-keyword\">from</span> openpyxl import Workbook<br><br>book = Workbook()<br>sheet = book.active<br><br>rows = (<br>    (88, 46, 57),<br>    (89, 38, 12),<br>    (23, 59, 78),<br>    (56, 21, 98),<br>    (24, 18, 43),<br>    (34, 15, 67)<br>)<br><br><span class=\"hljs-keyword\">for</span> row <span class=\"hljs-keyword\">in</span> rows:<br>    sheet.append(row)<br><br><span class=\"hljs-keyword\">for</span> row <span class=\"hljs-keyword\">in</span> sheet.iter_rows(<span class=\"hljs-attribute\">min_row</span>=1, <span class=\"hljs-attribute\">min_col</span>=1, <span class=\"hljs-attribute\">max_row</span>=6, <span class=\"hljs-attribute\">max_col</span>=3):<br>    <span class=\"hljs-keyword\">for</span> cell <span class=\"hljs-keyword\">in</span> row:<br>        <span class=\"hljs-built_in\">print</span>(cell.value, <span class=\"hljs-attribute\">end</span>=<span class=\"hljs-string\">&quot; &quot;</span>)<br>    <span class=\"hljs-built_in\">print</span>()    <br><br>book.save(<span class=\"hljs-string\">&#x27;iterbyrows.xlsx&#x27;</span>)<br></code></pre></td></tr></table></figure>\n\n<h3 id=\"8-按列迭代\"><a href=\"#8-按列迭代\" class=\"headerlink\" title=\"8.按列迭代\"></a>8.按列迭代</h3><figure class=\"highlight routeros\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs routeros\"><span class=\"hljs-comment\">#!/usr/bin/env python</span><br><br><span class=\"hljs-keyword\">from</span> openpyxl import Workbook<br><br>book = Workbook()<br>sheet = book.active<br><br>rows = (<br>    (88, 46, 57),<br>    (89, 38, 12),<br>    (23, 59, 78),<br>    (56, 21, 98),<br>    (24, 18, 43),<br>    (34, 15, 67)<br>)<br><br><span class=\"hljs-keyword\">for</span> row <span class=\"hljs-keyword\">in</span> rows:<br>    sheet.append(row)<br><br><span class=\"hljs-keyword\">for</span> row <span class=\"hljs-keyword\">in</span> sheet.iter_cols(<span class=\"hljs-attribute\">min_row</span>=1, <span class=\"hljs-attribute\">min_col</span>=1, <span class=\"hljs-attribute\">max_row</span>=6, <span class=\"hljs-attribute\">max_col</span>=3):<br>    <span class=\"hljs-keyword\">for</span> cell <span class=\"hljs-keyword\">in</span> row:<br>        <span class=\"hljs-built_in\">print</span>(cell.value, <span class=\"hljs-attribute\">end</span>=<span class=\"hljs-string\">&quot; &quot;</span>)<br>    <span class=\"hljs-built_in\">print</span>()    <br><br>book.save(<span class=\"hljs-string\">&#x27;iterbycols.xlsx&#x27;</span>)<br></code></pre></td></tr></table></figure>\n\n",
            "tags": [
                "excel"
            ]
        }
    ]
}